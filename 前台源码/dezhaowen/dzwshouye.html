<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css" >
			ul,li{
				margin: 0px;
				padding: 0px;
			}
			body,html{
				margin: 0px;
				padding: 0px;
				height: 100%;
			}
			#ctn{
				height: 100%;
				width: 100%;
			}
			.header{
				padding-top: 20px;
				padding-left: 200px;
				margin-left: -20px;
				height: 12%;
				background-color: #18416b;	
				width: 102.3%;		
			}
			.container{
				margin: 0px;
				padding: 0px;
			}
			.dropdown span{
				color: white;
			}
			.row>div,.tab-content,.tab-content>div{
				height: 95%;
			}
			.row>div:nth-child(1) ul{
				
			}
			.row>div:nth-child(1){
				border-right: 2px solid gray ;
				height: 100%;
				padding-top: 15px;
				background-color: #18416b;
			}
			.row>div:nth-child(1) a{
				color: white;
			}
			.row{
				height: 88%;
			}
			iframe{
				border: 0px;
				height: 100%;
				width: 100%;
			}
			.tabclose{
				position: absolute;
				top: 0px;
				right: 0px;
			}
			.dropdown{
				text-align: center;
			}
			nav ul {
			    float:left;
			    list-style: none;
			}
			nav ul li {
			    display: inline;
			}
			nav ul li span {
			    float: left;
			    padding: 11px 20px; 
			    font-size: 14px;
			    color: #ddd;
			    text-align: center;    
			}
			.img{
				position: absolute;
				top: 20px;
				left: 40px;
			}
			.submenu >ul{
            	display: none;
	        }
	        .open>ul{
	            display: block;
	        }
	        #sidebar ul{
	        	list-style: none;
	        }
	        #sidebar ul li a,ul{
	        	text-align: center;
	        }
	        .header div span{
	        	color: white;
				position: relative;
				top: 0px;
				left: 250px;
	        	margin-left: 40px;
	        }
			.dropdown li{
				color: white;
				list-style: none;
			}
			.header-div{
				position: absolute;
				top: 15px;
				left: 940px;
			}
		</style>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
	</head>
	<body>
		<div id="ctn" class="container-fluid">
			<div class="header">
				<nav>
					<div class="img"><img src="img/dzwlog.png" width="150px" height="40px" /></div>
				    <ul>
				      <li v-for="item in menu" @click="selectedMenu=item"><span :title="item.menuName">{{item.menuName}}</span></li>
				    </ul>
				 </nav>
				 <div class="header-div">
				 	<span><img src="img/jsee1.PNG" />设置</span>
				 	<span>注释</span>
				 	<span><img src="img/jsee2.PNG" />退出</span>
				 </div>
			</div>
			<div class="row">
				<div class="col-sm-1" >
					<div class="dropdown">
					  	<div>
						    
						    <ul>
						    	<li @click="createTab(item)" v-for="item in selectedMenu.children">
						    		{{item.menuName}}
						    		<ul style="margin-left:20px" v-if="item.children">
								    	<li  @click="createTab(c)" v-for="c in item.children">
								    		{{c.menuName}}
								    	</li>
								    </ul>	
						    	</li>

						    </ul>	
					 	 </div>
					</div>
				</div>
				<div class="col-sm-11">
					<ul class="nav nav-tabs">
						<li :class="{active:item.active}" v-for="item,index in tabs" ><a href="javascript:void(0)" :data-target="'#'+item.perms"  data-toggle="tab"><span @click="removetab(index)" class="close tabclose">&times;</span>{{item.menuName}}</a></li>
					</ul>
					<div class="tab-content">
						<div v-for="item in tabs" :id="item.perms" :class="['tab-pane',item.active?'active':'false']">
							<iframe :src="item.url"></iframe>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script>
			var baseUrl = "http://localhost:8080/";
		</script>
		<script type="text/javascript" src="js/jquery-1.12.4.js" charset="UTF-8" ></script>
		<script type="text/javascript" src="js/bootstrap.min.js" charset="UTF-8"></script>
		<script src="js/vue.js" type="text/javascript" charset="UTF-8" ></script>
		<script type="text/javascript" src="js/menu.js" ></script>
		<script type="text/javascript">
			var user=sessionStorage.getItem("user");
			if(!user){
				window.location.href="new_file.html"; 
			}
			var tabs=[
			{
				id:0,
				menuName:"首页",
				perms:"index",
				active:true,
				url:"jszxsy/dzwindex.html"
			}
			];
			new Vue({
				el:"#ctn",
				data(){
					return{
						menu:[],
						selectedMenu:[],
						tabs:tabs
					}
				},
				methods:{
					createTab(item){
						if(item.children && item.children.length>0){
							return;
						}
						this.tabs.forEach(item=>item.active=false);
						this.$set(item,"active",true);
						var flag = this.tabs.some(sitem=>sitem.perms==item.perms)
						if(!flag){
							this.tabs.push(item);
						}
					},
					removetab(index){
						this.tabs.splice(index,1);
						if(index==this.tabs.length-1){
							this.tabs[index-1].active= true;
						}
					}
				},
				created(){
					var ss=sessionStorage.getItem("user");
					var u=JSON.parse(ss);
					console.log(u);
					this.user=u;
					let that=this;
					menuApi.findMenuByUserId(u.roleId,function(result){
					console.log(result);
					that.menu = result;
					that.selectedMenu = that.menu[0];
					console.log(that.selectedMenu);
					});
				}
			});
		</script>
	</body>
</html>
